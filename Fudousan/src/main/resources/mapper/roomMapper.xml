<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.real.fudousan.room.dao.RoomMapper">
	<resultMap type="room" id="roomResultMap">
		<id 		 property="roomId"			column="ROOM_ID"/>
		<result 	 property="snapshot" 		column="SNAPSHOT"/>
		<result 	 property="map"  			column="MAP"/>
		<result 	 property="creDate"			column="CRE_DATE"/>
		<result 	 property="delDate"     	column="DEL_DATE"/>
		<result 	 property="heigth"      	column="HEIGTH"/>
		<result 	 property="memberId"  		column="MEMBER_ID"/>
		<association property="estate"   		column="estate_id" 			javaType="com.real.fudousan.estate.vo.Estate" resultMap="com.real.fudousan.estate.dao.EstateMapper.estateResultMap"/>
		<association property="floorTexture"   	column="FLOOR_TEXTURE_ID" 	javaType="com.real.fudousan.texture.vo.Texture" resultMap="com.real.fudousan.texture.dao.TextureMapper.textureResultMap" columnPrefix="f_"/>
		<association property="ceilingTexture"  column="CEILING_TEXTURE_ID" javaType="com.real.fudousan.texture.vo.Texture" resultMap="com.real.fudousan.texture.dao.TextureMapper.textureResultMap" columnPrefix="c_"/>
	</resultMap>


<select id="searchRoomInfo" resultMap="roomResultMap">
		select
			ROOM_ID
			,SNAPSHOT
			,MAP
			,ROOM.CRE_DATE CRE_DATE
			,ROOM.DEL_DATE DEL_DATE
			,HEIGTH
			,FLOOR_TEXTURE_ID
			,CEILING_TEXTURE_ID
			,MEMBER_ID
			,ROOM.ESTATE_ID ESTATE_ID 
			,Region
			,Prefecture
			,Municipality
			,DistrictName
			,NearestStation
			,TimeToNearestStation
			,TradePrice
			,PricePerUnit
			,FloorPlan
			,Area
			,UnitPrice
			,LandShape
			,Frontage
			,TotalFloorArea
			,BuildingYear
			,Structure
			,Use
			,Purpose
			,Direction
			,Classification
			,Breadth
			,CityPlanning
			,CoverageRatio
			,FloorAreaRatio
			,Period
			,Renovation
			,Remarks
			,estate.DEL_DATE estate_DEL_DATE
			,estate.MunicipalityCode_ID MunicipalityCode_ID
			,estate.TRANS_TYPE_ID TRANS_TYPE_ID
			,f.TEXTURE_ID f_TEXTURE_ID
			,f.TEXTURE_TYPE_ID f_TEXTURE_TYPE_ID
			,f.MEMBER_ID f_MEMBER_ID
			,f.TEXTURE_NAME f_TEXTURE_NAME
			,f.TEXT f_TEXT
			,f.TEXTURE_FILE f_TEXTURE_FILE
			,f.CRE_DATE f_CRE_DATE
			,f.DEL_DATE f_DEL_DATE
			,c.TEXTURE_ID c_TEXTURE_ID
			,c.TEXTURE_TYPE_ID c_TEXTURE_TYPE_ID
			,c.MEMBER_ID c_MEMBER_ID
			,c.TEXTURE_NAME c_TEXTURE_NAME
			,c.TEXT c_TEXT
			,c.TEXTURE_FILE c_TEXTURE_FILE
			,c.CRE_DATE c_CRE_DATE
			,c.DEL_DATE c_DEL_DATE
			,tf.NAME f_NAME
			,tf.TEXT f_TEXT
			,cf.NAME c_NAME
			,cf.TEXT c_TEXT
		from
			room
		left outer join
			TEXTURE f
		on
			room.FLOOR_TEXTURE_ID = f.TEXTURE_ID
		left outer join
			TEXTURE c
		on
			room.CEILING_TEXTURE_ID = c.TEXTURE_ID
		left outer join
			TEXTURE_TYPE tf
		on
			f.TEXTURE_TYPE_ID = tf.TEXTURE_TYPE_ID
		left outer join
			TEXTURE_TYPE cf
		on
			c.TEXTURE_TYPE_ID = cf.TEXTURE_TYPE_ID
		join
			ESTATE
		on
			room.ESTATE_ID = estate.ESTATE_ID
		join
			MunicipalityCode
		on
			estate.MunicipalityCode_ID = municipalitycode.MunicipalityCode_ID
		join
			TRANS_TYPE
		on
			estate.TRANS_TYPE_ID = trans_type.TRANS_TYPE_ID
		where
			estate.ESTATE_NAME = #{0} and room.MEMBER_ID = #{1}
	</select>
	
<!-- 일반고객이 자신이 작성 한 매물 검색하는것 -->
<!-- 
<select id="searchRoomInfo" resultType="room">
	select
		room_id
		,estate_id
		,snapshot
		,map
		,cre_date
		,del_date
		,heigth
		,floor_Texture_id
		,ceiling_Texture_id
		,member_id AS memberId
	from
		room
	where
		estate_Id = #{0} and member_id = #{1}
</select>
-->
<!-- 일반 고객이 자신의 마이페이지에 접속하면 자신이 작성한 매물 전체 출력 -->
<!-- 
<select id="allMyRoom" resultType="room" parameterType="int">
	select
		ROOM_ID
		,ESTATE_ID
		,SNAPSHOT
		,MAP
		,CRE_DATE
		,DEL_DATE
		,HEIGTH
		,FLOOR_TEXTURE_ID
		,CEILING_TEXTURE_ID
		,member_id AS memberId
	from
		room
	where
		member_id = #{member_id}
</select>
 -->
		<!-- member_id = #{0} 파라메터가 1개니까 뭘 써도 상관없다-->





	<select id="allMyRoom" resultMap="roomResultMap" parameterType="int">
		select
			ROOM_ID
			,SNAPSHOT
			,MAP
			,ROOM.CRE_DATE CRE_DATE
			,ROOM.DEL_DATE DEL_DATE
			,HEIGTH
			,FLOOR_TEXTURE_ID
			,CEILING_TEXTURE_ID
			,MEMBER_ID
			,ROOM.ESTATE_ID ESTATE_ID 
			,Region
			,Prefecture
			,Municipality
			,DistrictName
			,NearestStation
			,TimeToNearestStation
			,TradePrice
			,PricePerUnit
			,FloorPlan
			,Area
			,UnitPrice
			,LandShape
			,Frontage
			,TotalFloorArea
			,BuildingYear
			,Structure
			,Use
			,Purpose
			,Direction
			,Classification
			,Breadth
			,CityPlanning
			,CoverageRatio
			,FloorAreaRatio
			,Period
			,Renovation
			,Remarks
			,estate.DEL_DATE estate_DEL_DATE
			,estate.MunicipalityCode_ID MunicipalityCode_ID
			,estate.TRANS_TYPE_ID TRANS_TYPE_ID
			,f.TEXTURE_ID f_TEXTURE_ID
			,f.TEXTURE_TYPE_ID f_TEXTURE_TYPE_ID
			,f.MEMBER_ID f_MEMBER_ID
			,f.TEXTURE_NAME f_TEXTURE_NAME
			,f.TEXT f_TEXT
			,f.TEXTURE_FILE f_TEXTURE_FILE
			,f.CRE_DATE f_CRE_DATE
			,f.DEL_DATE f_DEL_DATE
			,c.TEXTURE_ID c_TEXTURE_ID
			,c.TEXTURE_TYPE_ID c_TEXTURE_TYPE_ID
			,c.MEMBER_ID c_MEMBER_ID
			,c.TEXTURE_NAME c_TEXTURE_NAME
			,c.TEXT c_TEXT
			,c.TEXTURE_FILE c_TEXTURE_FILE
			,c.CRE_DATE c_CRE_DATE
			,c.DEL_DATE c_DEL_DATE
			,tf.NAME f_NAME
			,tf.TEXT f_TEXT
			,cf.NAME c_NAME
			,cf.TEXT c_TEXT
		from
			room
		left outer join
			TEXTURE f
		on
			room.FLOOR_TEXTURE_ID = f.TEXTURE_ID
		left outer join
			TEXTURE c
		on
			room.CEILING_TEXTURE_ID = c.TEXTURE_ID
		left outer join
			TEXTURE_TYPE tf
		on
			f.TEXTURE_TYPE_ID = tf.TEXTURE_TYPE_ID
		left outer join
			TEXTURE_TYPE cf
		on
			c.TEXTURE_TYPE_ID = cf.TEXTURE_TYPE_ID
		join
			ESTATE
		on
			room.ESTATE_ID = estate.ESTATE_ID
		join
			MunicipalityCode
		on
			estate.MunicipalityCode_ID = municipalitycode.MunicipalityCode_ID
		join
			TRANS_TYPE
		on
			estate.TRANS_TYPE_ID = trans_type.TRANS_TYPE_ID
		where
			room.MEMBER_ID = #{MEMBER_ID}
	</select>
	
	<select id="selectByIds" resultMap="roomResultMap" parameterType="java.util.Set">
		select
			ROOM_ID
			,SNAPSHOT
			,MAP
			,ROOM.CRE_DATE CRE_DATE
			,ROOM.DEL_DATE DEL_DATE
			,HEIGTH
			,FLOOR_TEXTURE_ID
			,CEILING_TEXTURE_ID
			,MEMBER_ID
			,ROOM.ESTATE_ID ESTATE_ID 
			,Region
			,Prefecture
			,Municipality
			,DistrictName
			,NearestStation
			,TimeToNearestStation
			,TradePrice
			,PricePerUnit
			,FloorPlan
			,Area
			,UnitPrice
			,LandShape
			,Frontage
			,TotalFloorArea
			,BuildingYear
			,Structure
			,Use
			,Purpose
			,Direction
			,Classification
			,Breadth
			,CityPlanning
			,CoverageRatio
			,FloorAreaRatio
			,Period
			,Renovation
			,Remarks
			,estate.DEL_DATE estate_DEL_DATE
			,estate.MunicipalityCode_ID MunicipalityCode_ID
			,estate.TRANS_TYPE_ID TRANS_TYPE_ID
			,f.TEXTURE_ID f_TEXTURE_ID
			,f.TEXTURE_TYPE_ID f_TEXTURE_TYPE_ID
			,f.MEMBER_ID f_MEMBER_ID
			,f.TEXTURE_NAME f_TEXTURE_NAME
			,f.TEXT f_TEXT
			,f.TEXTURE_FILE f_TEXTURE_FILE
			,f.CRE_DATE f_CRE_DATE
			,f.DEL_DATE f_DEL_DATE
			,c.TEXTURE_ID c_TEXTURE_ID
			,c.TEXTURE_TYPE_ID c_TEXTURE_TYPE_ID
			,c.MEMBER_ID c_MEMBER_ID
			,c.TEXTURE_NAME c_TEXTURE_NAME
			,c.TEXT c_TEXT
			,c.TEXTURE_FILE c_TEXTURE_FILE
			,c.CRE_DATE c_CRE_DATE
			,c.DEL_DATE c_DEL_DATE
			,tf.NAME f_NAME
			,tf.TEXT f_TEXT
			,cf.NAME c_NAME
			,cf.TEXT c_TEXT
		from
			room
		left outer join
			TEXTURE f
		on
			room.FLOOR_TEXTURE_ID = f.TEXTURE_ID
		left outer join
			TEXTURE c
		on
			room.CEILING_TEXTURE_ID = c.TEXTURE_ID
		left outer join
			TEXTURE_TYPE tf
		on
			f.TEXTURE_TYPE_ID = tf.TEXTURE_TYPE_ID
		left outer join
			TEXTURE_TYPE cf
		on
			c.TEXTURE_TYPE_ID = cf.TEXTURE_TYPE_ID
		join
			ESTATE
		on
			room.ESTATE_ID = estate.ESTATE_ID
		join
			MunicipalityCode
		on
			estate.MunicipalityCode_ID = municipalitycode.MunicipalityCode_ID
		join
			TRANS_TYPE
		on
			estate.TRANS_TYPE_ID = trans_type.TRANS_TYPE_ID
		where
			room.room_id IN <foreach collection="_parameter" item="roomId" open="(" separator=", " close=")">#{roomId}</foreach>
	</select>
	
	
</mapper>
